<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>JSON Tool</title>
    <link th:href="@{/iview/iview.css}" rel="stylesheet"/>
    <script th:src="@{/libs/jquery-3.2.1.min.js}"></script>
    <script th:src="@{/libs/vue.min.js}"></script>
    <script th:src="@{/iview/iview.min.js}"></script>
    <style>
        .container {
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        .text-area {
            margin: 10px 0;
            width: 100%;
        }
        .button-group {
            margin: 10px 0;
            display: flex;
            gap: 10px;
            justify-content: flex-start;
        }
        .copy-button {
            margin-top: 10px;
        }
    </style>
</head>
<body>
<div id="app" class="container">
    <h2>JSON Tool</h2>
    
    <i-input type="textarea" 
             v-model="inputText" 
             :rows="12"
             placeholder="Input JSON here..."
             class="text-area">
    </i-input>

    <div class="button-group">
        <i-button type="primary" @click="validate">
            <i class="fa fa-check"></i> Validate
        </i-button>
        <i-button type="primary" @click="beautify">
            <i class="fa fa-indent"></i> Beautify
        </i-button>
        <i-button type="primary" @click="minify">
            <i class="fa fa-compress"></i> Minify
        </i-button>
        <i-button type="warning" @click="clear">
            <i class="fa fa-trash"></i> Clear
        </i-button>
    </div>

    <i-input type="textarea" 
             v-model="outputText" 
             :rows="12"
             readonly
             placeholder="Output"
             class="text-area">
    </i-input>

    <i-button type="success" 
              @click="copyToClipboard" 
              class="copy-button"
              :disabled="!outputText">
        <i class="fa fa-copy"></i> Copy to clipboard
    </i-button>
</div>

<script>
new Vue({
    el: '#app',
    data: {
        inputText: '',
        outputText: ''
    },
    methods: {
        // Clear all input and output text
        clear() {
            this.inputText = '';
            this.outputText = '';
            this.$Notice.success({
                title: 'Success',
                desc: 'All content cleared'
            });
        },
        
        // Validate JSON
        validate() {
            try {
                if (!this.inputText.trim()) {
                    this.$Notice.warning({
                        title: 'Warning',
                        desc: 'Please input JSON text'
                    });
                    return;
                }
                
                JSON.parse(this.inputText);
                this.outputText = "JSON format is valid!";
                this.$Notice.success({
                    title: 'Success',
                    desc: 'JSON validation passed'
                });
            } catch (e) {
                this.outputText = "JSON format error: " + e.message;
                this.$Notice.error({
                    title: 'Error',
                    desc: 'JSON validation failed'
                });
            }
        },
        
        // Beautify JSON
        beautify() {
            try {
                if (!this.inputText.trim()) {
                    this.$Notice.warning({
                        title: 'Warning',
                        desc: 'Please input JSON text'
                    });
                    return;
                }
                
                const obj = JSON.parse(this.inputText);
                this.outputText = JSON.stringify(obj, null, 2);
                this.$Notice.success({
                    title: 'Success',
                    desc: 'JSON beautification completed'
                });
            } catch (e) {
                this.$Notice.error({
                    title: 'Error',
                    desc: 'JSON format error: ' + e.message
                });
            }
        },
        
        // Minify JSON
        minify() {
            try {
                if (!this.inputText.trim()) {
                    this.$Notice.warning({
                        title: 'Warning',
                        desc: 'Please input JSON text'
                    });
                    return;
                }
                
                const obj = JSON.parse(this.inputText);
                this.outputText = JSON.stringify(obj);
                this.$Notice.success({
                    title: 'Success',
                    desc: 'JSON minification completed'
                });
            } catch (e) {
                this.$Notice.error({
                    title: 'Error',
                    desc: 'JSON format error: ' + e.message
                });
            }
        },
        
        // Copy to clipboard
        copyToClipboard() {
            navigator.clipboard.writeText(this.outputText).then(() => {
                this.$Notice.success({
                    title: 'Success',
                    desc: 'Copied to clipboard'
                });
            }).catch(err => {
                // Fallback solution
                const textarea = document.createElement('textarea');
                textarea.value = this.outputText;
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    document.execCommand('copy');
                    this.$Notice.success({
                        title: 'Success',
                        desc: 'Copied to clipboard'
                    });
                } catch (e) {
                    this.$Notice.error({
                        title: 'Error',
                        desc: 'Copy failed'
                    });
                }
                document.body.removeChild(textarea);
            });
        }
    }
});
</script>
</body>
</html> 